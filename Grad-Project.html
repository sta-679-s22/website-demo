<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Kate Boyer" />


<title>Grad Project</title>

<script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Welcome to my website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="analysis.html">Analysis</a>
</li>
<li>
  <a href="Grad-Project.html">Grad Project</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lucymcgowan">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/lucymcgowan">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Grad Project</h1>
<h4 class="author">Kate Boyer</h4>
<h4 class="date">4/12/2022</h4>

</div>


<div id="no-interference-assumption-a-simulation" class="section level2">
<h2>No Interference Assumption: A Simulation</h2>
<p>Like with any statistical method, some assumptions are made when performing causal inference. One of which is the assumption that there is no interference. This assumption is part of the stable unit value treatment assumption (SUTVA). The no interference assumption states that:</p>
<p><em>“The potential outcomes for any unit do not vary with the exposures assigned to other units.”</em></p>
<p>This means that each unit’s potential outcomes must be consistent regardless of the exposures of the other units. For example, if my potential outcomes are that I am happy when I win money and sad when I don’t, I must still be just as happy winning money if everyone around me does not win any.</p>
<p>One setting where the no interference assumption is easily violated if study investigators are not careful is vaccine trials.</p>
</div>
<div id="an-example" class="section level2">
<h2>An Example</h2>
<p>Following is a simulation of this setting to illustrate the consequences of violating this assumption, and an alternate way to design vaccine trials to avoid doing so.</p>
<p>Here we create 5 hospitals, each with 100 participants who are taking part in the trial, and we randomize each participant to have a 50% chance of receiving the vaccine and a 50% chance of receiving a placebo. We make sure the chance of being exposed to the virus is lower in the hospitals with higher vaccination rates by setting it equal to 1-the vaccination rate.</p>
<pre class="r"><code>observations=tibble(
  id = 1:500,
  hospital = rep(c(1,2,3,4,5), each = 100),
  vaccinated = rbinom(500, 1, 0.5)
)

observations%&gt;%group_by(hospital) %&gt;%
  summarise(exposure_chance = 1 - mean(vaccinated))-&gt;e</code></pre>
<p>Those in hospitals with higher vaccination rates will have more people protected by the vaccine, so the virus will have fewer chances to spread, and this will increase protection for everyone in the hospital rather than just those who are vaccinated.</p>
<p>Next, we create the potential outcomes for each participant. For the purposes of this example, we are assuming the vaccine performs perfectly. So, the potential outcomes for each participant are that they do not get sick if they are vaccinated, but if they are not vaccinated, they do get sick with probability that they were exposed to the virus.</p>
<pre class="r"><code>observations=observations %&gt;%
  left_join(e) %&gt;%
  mutate(y0=rbinom(500, 1, exposure_chance), ##if you are not vaccinated, you get sick if you are infected. so you get sick with probability that you are infected 
         y1=0, ##if you are vaccinated, never get sick
         yobs=ifelse(vaccinated, y0, y1))</code></pre>
<pre><code>## Joining, by = &quot;hospital&quot;</code></pre>
<pre class="r"><code>observations%&gt;%
  group_by(vaccinated)%&gt;%
  summarise(outcome=mean(yobs))</code></pre>
<pre><code>## # A tibble: 2 × 2
##   vaccinated outcome
##        &lt;int&gt;   &lt;dbl&gt;
## 1          0   0    
## 2          1   0.466</code></pre>
<p>Here we can see that the difference in outcomes is less than 1/2, when we know the true causal effect is 1 since you get sick if you are not vaccinated and you do not get sick if you are. The violation to interference assumption is hiding much of the effect of the vaccine and making it look less protective than it actually is.</p>
</div>
<div id="how-to-fix-it" class="section level2">
<h2>How to Fix it:</h2>
<p>We can solve this problem by redefining our unit from the individual to the cluster. We will now simulate a randomization by hospital rather than by individual to show that the full effect of the vaccine is observed.</p>
<pre class="r"><code>corrected = tibble(
  hospital = rep(c(1,2,3,4,5), each = 1),
  vaccinated = rbinom(5, 1, 0.5),
  exposure_chance=1-vaccinated
)</code></pre>
<p>We still make the exposure chance equal to one minus the vaccination rate, but now that we are randomizing by hospital, each hospital has either 100% or 0% vaccination rate, so the exposure probabilities are either 0 or 1.</p>
<pre class="r"><code>corrected%&gt;%group_by(hospital) %&gt;%
  summarise(exposure_chance = 1 - mean(vaccinated))</code></pre>
<pre><code>## # A tibble: 5 × 2
##   hospital exposure_chance
##      &lt;dbl&gt;           &lt;dbl&gt;
## 1        1               0
## 2        2               1
## 3        3               1
## 4        4               0
## 5        5               0</code></pre>
<p>Let’s look at the effect of the vaccine after randomizing by hospital.</p>
<pre class="r"><code>observations2=tibble(
  id = 1:500,
  hospital = rep(c(1,2,3,4,5), each = 100),
)
observations2 %&gt;% left_join(corrected)%&gt;%
  mutate(y0=rbinom(500, 1, exposure_chance), ##if you are not vaccinated, you get sick if you are infected. so you get sick with probability that you are infected 
         y1=0, ##if you are vaccinated, never get sick
         yobs=ifelse(vaccinated, y1, y0))%&gt;%
  group_by(vaccinated) %&gt;%
  summarise(outcome=mean(yobs))</code></pre>
<pre><code>## Joining, by = &quot;hospital&quot;</code></pre>
<pre><code>## # A tibble: 2 × 2
##   vaccinated outcome
##        &lt;int&gt;   &lt;dbl&gt;
## 1          0       1
## 2          1       0</code></pre>
<p>Now that we have met the assumption of no interference by randomizing by the hospital rather than by the individual, the whole effect of the vaccine is observed when looking at the outcome among those not vaccinated (1) - among those vaccinated (0) = 1.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
